
import argparse
import copy
import os
from enum import Enum
from typing import Dict, List, Union

import numpy as np
import pandas as pd
import torch
from config.configuration import Config
from data.dataloader import GeneralTrainerDataLoader
from data.dataset import GeneralDataset
from data.interaction import Interaction
from data.utils import data_reparation
from models import NeuMF
from root import DATASET_DIR, ROOT_DIR, absolute
from torch.nn.utils import rnn as rnn_utils
from torch.utils.data import Dataset as TorchDataset
from trainer import Trainer
from utils.logger import init_logger
import hashlib
from FlagEmbedding import FlagModel

from sentence_transformers import SentenceTransformer
text = """

            The following content pertains to the personal attributes of the user 0:
            When initiating requests, user 0 has the geographical coordinates 38.0 and -97.0, located in United States, belongs to autonomous system AS7018 AT&T Services, Inc., and uses the IP address 12.108.127.138 with the IP number 208437130 while accessing web services.
            The following content pertains to the behavioral attributes of the user 0:
            User 0.0 invokes Service 3650.0 with a QoS value of 0.08900000154972076. 
Service 1551.0 of 0.5709
Service 1272.0 of 0.1420
Service 2328.0 of 6.7589
Service 3081.0 of 5.5510
Service 4790.0 of 5.4980
Service 1051.0 of 0.3950
Service 2773.0 of 0.1230
Service 2069.0 of 5.6570
Service 3608.0 of 5.3200
Service 1227.0 of 0.2099
Service 3975.0 of 0.0979
Service 299.0 of 11.371
Service 3334.0 of 0.5590
Service 5554.0 of 5.8930
Service 1711.0 of 0.1400
Service 725.0 of 0.2730
Service 4709.0 of 0.6769
Service 3045.0 of 0.4009
Service 5711.0 of 0.1410
Service 3865.0 of 0.7310
Service 3549.0 of 0.0439
Service 818.0 of 11.414
Service 5167.0 of 0.6800
Service 1240.0 of 0.1180
Service 1480.0 of 1.6610
Service 1691.0 of 0.1439
Service 2392.0 of 7.5419
Service 3640.0 of 0.1689
Service 591.0 of 5.6149
Service 2870.0 of 0.1070
Service 5375.0 of 5.3800
Service 4406.0 of 0.0810
Service 3282.0 of 2.7269
Service 1152.0 of 0.3459
Service 1455.0 of 5.6900
Service 5229.0 of 0.1140
Service 4898.0 of 5.5320
Service 1481.0 of 1.2460
Service 4267.0 of 0.0820
Service 1313.0 of 0.1180
Service 1525.0 of 5.6589
Service 4542.0 of 5.4289
Service 1557.0 of 0.6100
Service 203.0 of 0.4930
Service 2563.0 of 6.3280
Service 318.0 of 9.9589
Service 637.0 of 0.2199
Service 3952.0 of 0.0930
Service 4862.0 of 5.3369
Service 2481.0 of 0.1239
Service 5447.0 of 0.2389
Service 780.0 of 5.9050
Service 5279.0 of 5.1760
Service 5796.0 of 5.2480
Service 1179.0 of 1.9620
Service 574.0 of 0.4070
Service 1265.0 of 0.1150
Service 2816.0 of 0.1080
Service 252.0 of 0.1180
Service 4987.0 of 6.0869
Service 2322.0 of 0.375.
Service 5694.0 of 0.4580
Service 3685.0 of 0.0879
Service 3728.0 of 5.2810
Service 1389.0 of 0.1289
Service 2775.0 of 0.1110
Service 4916.0 of 5.3959
Service 20.0 of 0.2399
Service 5193.0 of 5.9200
Service 3854.0 of 0.0850
Service 2908.0 of 0.1169
Service 2553.0 of 0.1379
Service 592.0 of 5.4219
Service 2871.0 of 0.1080
Service 5376.0 of 6.6760
Service 4290.0 of 5.2300
Service 3749.0 of 5.4939
Service 1444.0 of 5.7119
Service 2652.0 of 0.1679
Service 1614.0 of 0.1640
Service 3425.0 of 0.2140
Service 3366.0 of 0.0520
Service 2061.0 of 6.1199
Service 3227.0 of 0.1379
Service 2479.0 of 0.1360
Service 4064.0 of 0.0570
Service 4196.0 of 0.2980
Service 678.0 of 5.8319
Service 3253.0 of 0.0390
Service 1143.0 of 0.1309
Service 4719.0 of 5.5079
Service 2611.0 of 0.2980
Service 2052.0 of 0.1019
Service 3224.0 of 0.1209
Service 3858.0 of 0.0799
Service 1657.0 of 0.1430
Service 5386.0 of 0.7680
Service 4739.0 of 5.3819
Service 4169.0 of 5.6830
Service 3093.0 of 5.5819
Service 5630.0 of 0.1350
Service 1431.0 of 0.5720
Service 3484.0 of 1.8029
Service 4176.0 of 0.3039
Service 3498.0 of 0.1700
Service 4321.0 of 6.0980
Service 4273.0 of 0.3759
Service 1232.0 of 0.1889
Service 1866.0 of 0.4760
Service 4722.0 of 5.6209
Service 4920.0 of 5.2880
Service 3838.0 of 0.0860
Service 1705.0 of 0.1420
Service 1493.0 of 5.5980
Service 2535.0 of 5.7789
Service 5542.0 of 1.0190
Service 804.0 of 8.0959
Service 604.0 of 0.1770
Service 1012.0 of 0.4650
Service 682.0 of 0.3700
Service 2662.0 of 0.6809
Service 3218.0 of 0.1439
Service 3036.0 of 0.4850
Service 1891.0 of 5.8000
Service 2694.0 of 0.1089
Service 2560.0 of 0.5260
Service 4543.0 of 5.4380
Service 4011.0 of 0.0930
Service 1423.0 of 0.6719
Service 740.0 of 8.2259
Service 5141.0 of 8.6099
Service 1652.0 of 0.1679
Service 3011.0 of 7.8540
Service 5326.0 of 5.7259
Service 5565.0 of 0.4149
Service 2121.0 of 7.4460
Service 4367.0 of 0.0219
Service 5087.0 of 5.6950
Service 1002.0 of 5.6919
Service 1809.0 of 5.5289
Service 5011.0 of 5.2699
Service 5599.0 of 0.3269
Service 3030.0 of 4.0739
Service 5365.0 of 0.0829
Service 4922.0 of 5.3720
Service 4264.0 of 0.0820
Service 4502.0 of 5.2579
Service 1010.0 of 0.8769
Service 1285.0 of 0.1350
Service 521.0 of 0.2269
Service 3684.0 of 5.4029
Service 1781.0 of 5.5520
Service 4861.0 of 5.3439
Service 4616.0 of 5.7140
Service 2502.0 of 0.4370
Service 4407.0 of 0.0820
Service 4570.0 of 0.0340
Service 1269.0 of 0.1150
Service 568.0 of 11.184
Service 350.0 of 0.0979
Service 5269.0 of 5.1960
Service 579.0 of 5.2680
Service 1482.0 of 5.7709
Service 3323.0 of 0.2010
Service 1356.0 of 5.6750
Service 199.0 of 5.7950
Service 5320.0 of 5.2470
Service 806.0 of 10.526
Service 3949.0 of 5.5539
Service 5441.0 of 5.4299
Service 3236.0 of 0.1369
Service 3406.0 of 0.2280
Service 1909.0 of 2.1870
Service 4366.0 of 5.2490
Service 1360.0 of 0.5189
Service 565.0 of 5.6890
Service 5057.0 of 0.3379
Service 3257.0 of 0.0469
Service 3670.0 of 5.3460
Service 4829.0 of 5.4569
Service 3415.0 of 0.4790
Service 2976.0 of 0.2399
Service 5521.0 of 4.0279
Service 2900.0 of 0.1099
Service 5046.0 of 5.3000
Service 2699.0 of 0.1089
Service 1795.0 of 0.2619
Service 917.0 of 0.1239
Service 828.0 of 15.576
Service 1284.0 of 0.1459
Service 4805.0 of 0.3000
Service 1275.0 of 0.2419
Service 714.0 of 0.5239
Service 2928.0 of 0.1089
Service 5390.0 of 0.8849
Service 2845.0 of 0.1080
Service 4841.0 of 5.3769
Service 65.0 of 0.8199
Service 5157.0 of 5.8159
Service 981.0 of 5.4829
Service 2592.0 of 1.0889
Service 3751.0 of 0.0820
Service 9.0 of 0.6489
Service 2231.0 of 0.3440
Service 1733.0 of 0.1270
Service 2494.0 of 5.9409
Service 3472.0 of 0.0599
Service 1742.0 of 0.1360
Service 3983.0 of 0.0579
Service 4114.0 of 0.3700
Service 5455.0 of 0.1679
Service 4.0 of 0.2220
Service 1520.0 of 0.4359
Service 37.0 of 0.9819
Service 3015.0 of 0.1199
Service 2862.0 of 0.1080
Service 1591.0 of 5.7309
Service 1553.0 of 0.5839
Service 977.0 of 0.2730
Service 1644.0 of 0.1430
Service 1993.0 of 0.1140
Service 3657.0 of 0.0250
Service 2978.0 of 5.7659
Service 3806.0 of 5.2210
Service 1656.0 of 0.1430
Service 3200.0 of 0.1309
Service 170.0 of 0.3569
Service 2129.0 of 1.3450
Service 1196.0 of 5.7059
Service 524.0 of 0.2290
Service 3614.0 of 0.0939
Service 5176.0 of 6.1370
Service 298.0 of 0.1410
Service 2936.0 of 0.0960
Service 2103.0 of 5.6849
Service 58.0 of 5.8000
Service 5456.0 of 0.6299
Service 196.0 of 5.6469
Service 1470.0 of 0.6370
Service 2817.0 of 0.1080
Service 5417.0 of 0.3269
Service 2528.0 of 6.1020
Service 2440.0 of 9.7790
Service 209.0 of 5.6840
Service 5684.0 of 0.4230
Service 5379.0 of 5.2600
Service 3708.0 of 0.0529
Service 5158.0 of 6.4390
Service 1570.0 of 0.1330
Service 2296.0 of 6.5019
Service 3405.0 of 0.4690
Service 2382.0 of 0.1630
Service 4625.0 of 5.3559
Service 1120.0 of 0.2809
Service 3680.0 of 0.0149
Service 4713.0 of 5.9029
Service 3541.0 of 0.0619
Service 3823.0 of 0.0810
Service 4685.0 of 5.4689
Service 3916.0 of 0.0659
Service 602.0 of 0.1870
Service 718.0 of 5.9780
Service 4082.0 of 0.1010
Service 3660.0 of 0.625.
Service 3820.0 of 0.0810
Service 4634.0 of 0.2989
Service 1200.0 of 5.8790
Service 5006.0 of 5.2789
Service 3652.0 of 5.4650
Service 15.0 of 5.875.
Service 4285.0 of 0.0820
Service 3438.0 of 0.2220
Service 846.0 of 0.8529
Service 742.0 of 8.3599
Service 5511.0 of 0.2109
Service 2336.0 of 0.2579
Service 4342.0 of 0.0410
Service 2866.0 of 0.1080
Service 1369.0 of 6.4790
Service 3204.0 of 0.1209
Service 2279.0 of 0.8000
Service 1374.0 of 0.1459
Service 573.0 of 8.9949
Service 5483.0 of 0.0970
Service 4145.0 of 5.2410
Service 2600.0 of 6.0659
Service 3891.0 of 0.1140
Service 3404.0 of 5.4489
Service 3839.0 of 17.065
Service 2083.0 of 1.3650
Service 3982.0 of 0.3770
Service 1443.0 of 0.1270
Service 4601.0 of 0.1019
Service 4161.0 of 5.8010
Service 4872.0 of 5.5520

If personal and behavioral attributes are similar, it is assumed that two users will have the same QoS values when invoking the same services.
        
"""
print(len(text))
model = SentenceTransformer('BAAI/bge-small-en')
embeddings_1 = model.encode([text], normalize_embeddings=True)
print(embeddings_1)